[version]
path = "src/tagstr/__init__.py"

[build]
sources = ["src"]

[build.targets.wheel.force-include]
# When installed in editable mode Hatch inserts a tagstr.pth file that adds
# the project files to the system PATH. The file we include needs to come
# after this alphabetically so that it is loaded after the project is in the
# PATH. This should likely be fixed in Hatch at some point by simply renaming
# the file inserted by Hatch to something like "_tagstr.pth".
# See: https://github.com/pypa/hatch/discussions/827#discussioncomment-5643256
"src/tagstr.pth" = "~tagstr.pth"

[envs.default.scripts]
checks = [
    "hatch run lint:all",
    "hatch run test:all",
]
fixes = [
    "hatch run lint:fix",
]

[envs.lint]
skip-install = true
dependencies = ["ruff", "black", "mypy"]

[envs.lint.scripts]
all = ["style", "types"]
fix = [
    "black .",
    "ruff check --fix .",
]
style = [
    "black --check .",
    "ruff check .",
]
types = "mypy --strict src/tagstr"

[envs.test]
dependencies = ["pytest", "coverage"]

[envs.test.scripts]
all = ["pass", "cover"]
pass = "pytest tests"
cover = [
    "TAGSTR_DISABLE_IMPORT_HOOK=true coverage run -m pytest tests",
    "coverage report",
]
